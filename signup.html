<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>إنشاء حساب</title>
<style>
/* نفس CSS الخاص بك بدون تغيير */
body {
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(-45deg,#0f2027,#203a43,#2c5364,#0f2027);
  background-size: 400% 400%;
  animation: gradientMove 12s ease infinite;
  font-family: Tahoma;
  color:#fff;
}
@keyframes gradientMove {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
form{width:300px;display:flex;flex-direction:column}
input,select,button{margin:8px 0;padding:12px;border-radius:20px;border:2px solid #00e6ff;background:rgba(0,0,0,.2);color:#fff}
button{background:#00e6ff;color:#000;font-weight:bold;cursor:pointer}
.error{color:#ff4d4d;font-size:.9rem}
</style>
</head>
<body>

<form id="signupForm">
  <input id="username" placeholder="اسم المستخدم" required>
  <input id="email" type="email" placeholder="البريد الإلكتروني" required>
  <input id="password" type="password" placeholder="كلمة المرور" required>
  <input id="confirmPassword" type="password" placeholder="تأكيد كلمة المرور" required>
  <select id="region" required>
    <option value="">اختر المنطقة</option>
    <option value="الشرقية">الشرقية</option>
    <option value="الوسطى">الوسطى</option>
    <option value="الغربية">الغربية</option>
  </select>
  <div id="error" class="error"></div>
  <button>إنشاء الحساب</button>
</form>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyB-hbThdD4r_3V5L0ZC-Jqd5VW5VmvjrJE",
  authDomain: "salh-2e2e7.firebaseapp.com",
  projectId: "salh-2e2e7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const form = document.getElementById("signupForm");
const errorDiv = document.getElementById("error");

form.onsubmit = async e => {
  e.preventDefault();
  errorDiv.textContent = "";

  const username = username.value.trim();
  const email = email.value.trim();
  const pass = password.value;
  const confirm = confirmPassword.value;
  const region = region.value;

  if(pass !== confirm) return errorDiv.textContent="كلمتا المرور غير متطابقتين";

  try {
    const cred = await createUserWithEmailAndPassword(auth, email, pass);

    await setDoc(doc(db,"users",cred.user.uid),{
      displayName: username,
      email,
      region,
      role: "user",
      watchedVideos: []
    });

    location.href="index.html";
  } catch(err){
    errorDiv.textContent = err.message;
  }
};
</script>

</body>
</html>
